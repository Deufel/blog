<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datastar Arrow Key Tab Focus</title>
    <script type="module" src="https://cdn.jsdelivr.net/gh/starfederation/datastar@main/bundles/datastar.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .focusable {
            padding: 10px 15px;
            margin: 10px 0;
            border: 2px solid #ccc;
            border-radius: 5px;
            background: #f9f9f9;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .focusable:focus {
            border-color: #007acc;
            background: #e6f3ff;
            outline: none;
            box-shadow: 0 0 5px rgba(0, 122, 204, 0.3);
        }
        
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="instructions">
        <h3>Arrow Key Navigation Demo</h3>
        <p>Click on any button below, then use the <strong>down arrow</strong> key to advance to the next focusable element, or the <strong>up arrow</strong> key to go to the previous one.</p>
    </div>

    <!-- Signal to track current focus index -->
    <div data-signals-current-focus-index="0"></div>

    <!-- First button with arrow key navigation -->
    <button 
        class="focusable" 
        tabindex="0"
        data-on-keydown="
            if (evt.key === 'ArrowDown') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const nextIndex = (currentIndex + 1) % focusableElements.length;
                focusableElements[nextIndex].focus();
                $currentFocusIndex = nextIndex;
            } else if (evt.key === 'ArrowUp') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const prevIndex = currentIndex === 0 ? focusableElements.length - 1 : currentIndex - 1;
                focusableElements[prevIndex].focus();
                $currentFocusIndex = prevIndex;
            }
        "
    >
        Button 1 - Press ↓ or ↑ arrow keys
    </button>

    <button 
        class="focusable" 
        tabindex="0"
        data-on-keydown="
            if (evt.key === 'ArrowDown') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const nextIndex = (currentIndex + 1) % focusableElements.length;
                focusableElements[nextIndex].focus();
                $currentFocusIndex = nextIndex;
            } else if (evt.key === 'ArrowUp') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const prevIndex = currentIndex === 0 ? focusableElements.length - 1 : currentIndex - 1;
                focusableElements[prevIndex].focus();
                $currentFocusIndex = prevIndex;
            }
        "
    >
        Button 2 - Arrow navigation enabled
    </button>

    <input 
        type="text" 
        class="focusable" 
        placeholder="Input field - also navigable"
        data-on-keydown="
            if (evt.key === 'ArrowDown') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const nextIndex = (currentIndex + 1) % focusableElements.length;
                focusableElements[nextIndex].focus();
                $currentFocusIndex = nextIndex;
            } else if (evt.key === 'ArrowUp') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const prevIndex = currentIndex === 0 ? focusableElements.length - 1 : currentIndex - 1;
                focusableElements[prevIndex].focus();
                $currentFocusIndex = prevIndex;
            }
        "
    >

    <button 
        class="focusable" 
        tabindex="0"
        data-on-keydown="
            if (evt.key === 'ArrowDown') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const nextIndex = (currentIndex + 1) % focusableElements.length;
                focusableElements[nextIndex].focus();
                $currentFocusIndex = nextIndex;
            } else if (evt.key === 'ArrowUp') {
                evt.preventDefault();
                const focusableElements = document.querySelectorAll('.focusable');
                const currentIndex = Array.from(focusableElements).indexOf(el);
                const prevIndex = currentIndex === 0 ? focusableElements.length - 1 : currentIndex - 1;
                focusableElements[prevIndex].focus();
                $currentFocusIndex = prevIndex;
            }
        "
    >
        Button 3 - Last button
    </button>

    <!-- Display current focus index -->
    <div style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px;">
        Currently focused element index: <strong data-text="$currentFocusIndex"></strong>
    </div>

    <!-- Simpler version for just one button -->
    <hr style="margin: 30px 0;">
    <h3>Simpler Single Button Example</h3>
    <p>This button advances focus to the next element when you press the down arrow:</p>
    
    <button 
        data-on-keydown="
            if (evt.key === 'ArrowDown') {
                evt.preventDefault();
                const next = el.nextElementSibling;
                if (next && next.focus) {
                    next.focus();
                }
            }
        "
    >
        Simple Button - Press ↓ to focus next element
    </button>
    
    <input type="text" placeholder="This input will be focused when you press ↓ on the button above">
    
    <button>Another button</button>
</body>
</html>