<style id="css_5_layout">

@layer css_5_layout{

    body {
        position: relative;
        inset: 0;
        margin: 0; /* Essential */
        margin-inline: auto; /* allows for easy centering */
        height: 100svh;
        line-height: 1.5;
        overflow: hidden;
        overscroll-behavior: none;

        display: grid; /* ← ADD THIS! */
        grid-template:
            "header header header" auto
            "nav    main   aside"  1fr
        / auto   1fr    auto;

        /* THEME */
        background-color: var(--bg-color-body);
        gap: var(--gap-body);
    }

    body > header {background-color: var(--bg-color-header); grid-area: header;}
    body > nav    {background-color: var(--bg-color-nav); grid-area: nav;overflow-y: auto}
    body > aside  {background-color: var(--bg-color-aside); grid-area: aside;overflow-y: auto}
    body > main   {background-color: var(--bg-color-main); grid-area: main;overflow-y: auto}
}

@layer css_5_layout.primitives {
    :is(
            [class*="--cluster"],
            [class*="--flank"],
            [class*="--frame"],
            [class*="--grid"],
            [class*="--split"],
            [class*="--flex"]
        )
        > * {
        margin-block: 0;
        margin-inline: 0;
    }
    :where(
        [class*="--cluster"],
        [class*="--flank"],
        [class*="--frame"],
        [class*="--grid"],
        [class*="--stack"],
        [class*="--split"],
        [class*="--flex"]
    ) {
        gap: var(--size-1);
    }

    :where([class*="--cluster"]) {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start;
        align-items: center;
    }
    :where([class*="--flank"]) {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        --content-percentage: initial;
        --flank-size: initial;
    }
    :where([class*="--flank"]:not([class*="\:end"]) > :first-child),
    :where([class*="--flank"][class*="\:start"] > :first-child) {
        flex-basis: var(--flank-size, auto);
        flex-grow: 1;
    }
    :where([class*="--flank"]:not([class*="\:end"]) > :last-child),
    :where([class*="--flank"][class*="\:start"] > :last-child) {
        flex-basis: 0;
        flex-grow: 999;
        min-inline-size: var(--content-percentage, 50%);
    }
    :where([class*="--flank"][class*="\:end"] > :last-child) {
        flex-basis: var(--flank-size, auto);
        flex-grow: 1;
    }
    :where([class*="--flank"][class*="\:end"] > :first-child) {
        flex-basis: 0;
        flex-grow: 999;
        min-inline-size: var(--content-percentage, 50%);
    }


    :where([class*="--frame"]) {
        display: flex;
        aspect-ratio: 1 / 1;
        justify-content: center;
        align-items: center;
        overflow: hidden;
    }
    :where([class*="--frame"] > img),
    :where([class*="--frame"] > video) {
        block-size: 100%;
        inline-size: 100%;
        object-fit: cover;
    }
    :where([class*="--frame"][class*="\:square"]) {
        aspect-ratio: 1 / 1;
    }
    :where([class*="--frame"][class*="\:landscape"]) {
        aspect-ratio: 16 / 9;
    }
    :where([class*="--frame"][class*="\:portrait"]) {
        aspect-ratio: 9 / 16;
    }
    :where([class*="--grid"]) {
        display: grid;
        grid-template-columns: repeat(
            auto-fit,
            minmax(min(var(--min-column-size, 20ch), 100%), 1fr)
        );
        --min-column-size: initial;
    }
    :where([class*="--span-grid"]) {
        grid-column: 1 / -1;
    }
    :where([class*="--split"]) {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
    }
    :where([class*="--split"]),
    :where([class*="--split"][class*="\:row"]) {
        flex-direction: row;
        block-size: auto;
        inline-size: 100%;
    }
    :where([class*="--split"]:not([class*="\:column"]) > :first-child) {
        flex: 0 1 auto;
    }
    :where([class*="--split"][class*="\:column"]) {
        flex-direction: column;
        block-size: auto;
        inline-size: auto;
        align-self: stretch;
    }
    :where([class*="--stack"]) {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        align-items: stretch;
    }
    :where([class*="--flex"]) {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
    }
    :where([class*="--flex"]),
    :where([class*="--flex"][class*="\:row"]) {
        flex-direction: row;
        block-size: auto;
        inline-size: 100%;
    }
    :where([class*="--flex"][class*="\:column"]) {
        flex-direction: column;
        block-size: auto;
        inline-size: auto;
        align-self: stretch;
        align-items: stretch;
    }
    /* New :end modifier for --flex */
    :where([class*="--flex"][class*="\:end"]) {
        justify-content: flex-end;
    }
}

@layer css_5_layout.primitives {
    /* grid-lcr: will place 3 grid childeren in left center right; or iff 2 then left, right */
    .grid-lcr { display: grid; grid-template-columns: auto 1fr auto; align-items: baseline;}
    .grid-lcr > :nth-child(2):not(:last-child) { justify-self: center; }
    .grid-lcr > :nth-child(2):last-child { justify-self: end; }
    .grid-lcr > * { display: flex; align-items: center; line-height: 1.2; }

    /* Top-Middle-Bottom (exactly 3 children) */
    .grid-tmb { display: grid; grid-template-rows: auto 1fr auto; gap: 0; }
    .grid-tmb > :nth-child(2) { align-self: center; }

    /* Top-Top-Bottom (exactly 3 children, first 2 at top) */
    .grid-ttb { display: grid; grid-template-rows: auto auto 1fr; gap: 0; }
    .grid-ttb > :nth-child(3) { align-self: end; }

    /* Top-Bottom (exactly 2 children) */
    .grid-tb { display: grid; grid-template-rows: auto 1fr; gap: 0; }
    .grid-tb > :nth-child(2) { align-self: end; }
    }
}


</style>
